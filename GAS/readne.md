## スプレッドシートと自動集計の設定ガイド

計測データをリアルタイムで表示し、ランキングを自動集計するための「Google スプレッドシート」の準備手順です。
この設定を行うことで、あなたのGoogleドライブに計測データが自動で記録されるようになります。

### ステップ 1: スプレッドシートの作成

Google ドライブ を開きます。

計測データを保存したいフォルダ（drive_uploader で指定したフォルダと同じ場所推奨）を開きます。

左上の 「＋ 新規」 > 「Google スプレッドシート」 をクリックして、新しいシートを作成します。


### ステップ 2: スクリプトの登録

スプレッドシートのメニューから 「拡張機能」 > 「Apps Script」 をクリックします。

新しいタブでエディタが開きます。最初に入っている function myFunction() {...} はすべて削除して空にしてください。

以下のリンクから、設定用スクリプト（input_record.gs,menu.gs,ranking.gs）を開き、中身をすべてコピーしてください。


書き換えたら、ツールバーのフロッピーアイコン（💾）をクリックして保存します。プロジェクト名は適当でOKです（例: GymkhanaScript）。

### ステップ 4: トリガー（自動実行）の設定

データがアップロードされたら自動で取り込むように設定します。

Apps Script 画面の左側にある 「時計アイコン（トリガー）」 をクリックします。

右下の 「+ トリガーを追加」 ボタンをクリックします。

以下のように設定します：

実行する関数: importLatestCSVData

実行するデプロイ: Head

イベントのソース: 時間主導型

時間ベースのトリガーのタイプ: 分ベースのタイマー

時間の間隔: 1分おき（または5分おき）

「保存」 をクリックします。

【重要】初回のみ、Googleの承認画面が出ます

「アカウントを選択」画面が出たら、自分のアカウントをクリックします。

「このアプリは Google で確認されていません」と出たら、左下の 「詳細」 をクリックします。

さらに下に表示される 「(プロジェクト名)（安全ではないページ）に移動」 をクリックします。

最後に 「許可」 をクリックします。


ランキング: スプレッドシートのメニューに 「計測データ」 という項目が追加されます（画面をリロードすると出ます）。ここから 「全体ランキングシートを作成/更新」 を実行すると、全期間の集計結果が見られます。
